<h2>Manage Tags</h2>
<div class="chips"></div>
<script type="text/javascript">
    $(document).ready(function() {
        $(".chips").chips({
            data: <?=$tags?>,
            placeholder: 'Tag Title',
            secondaryPlaceholder: 'Tag Title',
            onChipAdd: function(e, chip) {
                let text = chip.childNodes[0].textContent;
                $.ajax({
                    url: '/api/tag/add',
                    method: 'POST',
                    data: { tag: text }
                }).done(function(data, status, xhr) {
                    M.toast({ html: data.message });
                }).fail(function(xhr, status, err) {
                    console.error(err);
                    this.deleteChip(this.options.data.length-1);
                    M.toast({ html: 'Something went wrong. Try again later' })
                });
            },
            onChipDelete: function(e, chip) {
                let text = chip.childNodes[0].textContent;
                $.ajax({
                    url: `/api/tag/${text}`,
                    method: 'DELETE'
                }).done(function(data, status, xhr) {
                    M.toast({ html: data.message });
                }).fail(function(xhr, status, err) {
                    console.error(err);
                    M.toast({ html: 'Something went wrong. Try again later' })
                });
            }
        })
    });
</script>