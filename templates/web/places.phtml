<?php if(!is_null($bannerImage)): ?>
    <div class="parallax-container">
        <div class="parallax"><img src="<?= $bannerImage ?>" alt="Banner Image"></div>
    </div>
<?php endif;?>

<div class="section white">
    <div class="row container">
        <div class="col l12 m12 s12">
            <img src="/images/<?= strtolower(implode('-', explode('_', $townParam))) ?>.jpg" class="responsive-img" alt="banner"/>
            
            <p style="white-space: pre-line; text-align: justify; margin-top: 0px; padding-top: 0px;">
                <?= strlen(trim($town['description'])) ? trim($town['description']) : "To be defined." ?>
            </p>
            
            <ul class="collapsible expandable">
                <li>
                    <div class="collapsible-header"><i class="material-icons">commute</i>How to get there?</div>
                    <div class="collapsible-body">
                        <span style="white-space: pre-line; text-align: justify; padding-top: 0px;">
                            <?= strlen(trim($town['commuterGuide'])) ? $town['commuterGuide'] : "<i>To be defined.</i>" ?>
                        </span>
                    </div>
                </li>
                <li>
                    <div class="collapsible-header"><i class="material-icons">info</i>Other Details</div>
                    <div class="collapsible-body">
                        <span style="white-space: pre-line; text-align: justify; margin-top: 0px;">
                            <?= strlen(trim($town['otherDetails'])) ? $town['otherDetails'] : "<i>To be defined.</i>" ?>
                        </span>
                    </div>
                </li>
                <li>
                    <div class="collapsible-header"><i class="material-icons">near_me</i>Places of Interest</div>
                    <div class="collapsible-body">
                        <p>You can view the places of interest in this destination <a href="https://www.google.com/maps/search/?api=1&query=<?= $poiQuery?>" target="_blank">here.</a></p>
                    </div>
                </li>
                <li>
                    <div class="collapsible-header"><i class="material-icons">photo_camera</i>Tourist Destinations</div>
                    <div class="collapsible-body">
                        <?php if (count($places) > 0): $arEnabledIndicator = '<div class="chip blue" style="font-weight: bold">AR Enabled</div>';?>
                            <?php for($pos = 0; $pos < count($places); $pos += 2) {
                                $firstArIndicator = $places[$pos]['arEnabled'] == 1 ? $arEnabledIndicator : null;

                                $secondDestinationBlock = '<div class="col l4 m4 s6">&nbsp;</div>';
                                $secondPos = $pos + 1;
                                if ($secondPos < count($places)) {
                                    $secondArIndicator = $places[$secondPos]['arEnabled'] == 1 ? $arEnabledIndicator : null;
                                    $secondDestinationBlock = <<<TOURIST_ELEMENT
                                        <div class="card col l4 m4 s6">
                                            <div class="card-image">
                                                <img src="{$places[$secondPos]['imageName']}" alt="{$places[$secondPos]['name']}" class="responsive-img"/>
                                            </div>
                                            <div class="card-content">
                                                <p style="font-weight: bold">{$places[$secondPos]['name']}</p>
                                                {$secondArIndicator}
                                                <p class="truncate">{$places[$secondPos]['description']}</p>
                                            </div>
                                            <div class="card-action">
                                                <a href="/place/{$places[$secondPos]['id']}">View Destination</a>
                                            </div>
                                        </div>
TOURIST_ELEMENT;
                                }

                                $element = <<<TOURIST_ELEMENT
                                        <div class="row">
                                            <div class="col l1 m1 show-on-med-and-up hide-on-small-only">&nbsp;</div>
                                            <div class="card col l4 m4 s6">
                                                <div class="card-image">
                                                    <img src="{$places[$pos]['imageName']}" alt="{$places[$pos]['name']}" class="responsive-img"/>
                                                </div>
                                                <div class="card-content">
                                                    <p style="font-weight: bold">{$places[$pos]['name']}</p>
                                                    {$firstArIndicator}
                                                    <p class="truncate">{$places[$pos]['description']}</p>
                                                </div>
                                                <div class="card-action">
                                                    <a href="/place/{$places[$pos]['id']}">View Destination</a>
                                                </div>
                                            </div>
                                            <div class="col l2 m2    show-on-med-and-up hide-on-small-only">&nbsp;</div>
                                            {$secondDestinationBlock}
                                            <div class="col l1 m1 show-on-med-and-up hide-on-small-only">&nbsp;</div>
                                        </div>                      
TOURIST_ELEMENT;

                            echo $element;
                            }?> 
                        <?php else:?>
                            <p style="font-weight: bold">No Tourist Destinations available.</p>
                        <?php endif;?>
                    </div>
                </li>
                <li>
                    <div class="collapsible-header"><i class="material-icons">local_offer</i>Products</div>
                    <div class="collapsible-body">
                        <?php if (count($products) > 0): ?>
                            <?php foreach($products as $product): ?>
                                <div class="card-panel grey lighten-2">
                                    <div class="row valign-wrapper">
                                        <div class="col l2 m3 s3">
                                            <img src="<?= $product['imageFile']?>" alt="<?= $product['name']?>" data-caption="<?= $product['name']?>" class="responsive-img materialboxed">
                                        </div>
                                        <div class="col l10 m10 s10">
                                            <p style="font-weight: bold"><?= $product['name']; ?></p>
                                            <?php if(strlen(trim($product['arLink'])) > 0): ?>
                                                <div class="chip blue" style="font-weight: bold;">AR Enabled</div>
                                                <br/>
                                            <?php endif;?>
                                            <?php if(strlen(trim($product['description'])) > 0):?>
                                                <p class="truncate"><?= $product['description']?>&nbsp;<a href="/product/<?= $product['id']?>">Read more.</a></p>
                                            <?php else: ?>
                                                <a href="/product/<?= $product['id']?>">View Destination</a>
                                            <?php endif;?>
                                        </div>
                                    </div>
                                </div>
                            <?php endforeach;?>
                        <?php else:?>
                            <p style="font-weight: bold">No Products available.</p>
                        <?php endif;?>
                    </div>
                </li>
                <li>
                    <div class="collapsible-header"><i class="material-icons">bar_chart</i>Open Data</div>
                    <div class="collapsible-body">
                        <p>You can view the open data for <?= $town['name']?> <a href="/open-data/<?= $townParam?>">here.</a></p>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>

<script>
    $(document).ready(function() {
        $('.parallax').parallax();
        $('.collapsible').collapsible({
            accordion: false
        });
        $(".materialboxed").materialbox();
    });
</script>